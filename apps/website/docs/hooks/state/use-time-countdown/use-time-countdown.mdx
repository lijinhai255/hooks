# useTimeCountdown

时间倒计时 Hook，用于计算当前时间到目标时间的倒计时。

## 代码演示

import UseTimeCountdownDemo from './components/UseTimeCountdown'

<UseTimeCountdownDemo />

## API

### 参数

| 参数 | 类型 | 描述 |
| --- | --- | --- |
| targetTime | `number \| Date \| string` | 目标时间，支持时间戳、Date 对象或日期字符串 |

### 返回值

| 属性 | 类型 | 描述 |
| --- | --- | --- |
| isTimeReached | `boolean` | 是否已到达目标时间 |
| formattedRemaining | `string` | 格式化的剩余时间字符串 |
| days | `number` | 剩余天数 |
| hours | `number` | 剩余小时数（0-23） |
| minutes | `number` | 剩余分钟数（0-59） |
| seconds | `number` | 剩余秒数（0-59） |

## 使用示例

### 基本用法

```tsx
import { useTimeCountdown } from '@miaoma-rhooks/hooks'

function CountdownTimer() {
  const targetDate = new Date('2024-12-31 23:59:59')
  const { isTimeReached, formattedRemaining } = useTimeCountdown(targetDate)

  if (isTimeReached) {
    return <div>时间到了！</div>
  }

  return <div>剩余时间：{formattedRemaining}</div>
}
```

### 使用时间戳

```tsx
import { useTimeCountdown } from '@miaoma-rhooks/hooks'

function TimestampCountdown() {
  // 1小时后（毫秒级时间戳）
  const targetTimestamp = Date.now() + 3600 * 1000
  const { formattedRemaining, hours, minutes, seconds } = useTimeCountdown(targetTimestamp)

  return (
    <div>
      <div>倒计时：{formattedRemaining}</div>
      <div>{hours}时 {minutes}分 {seconds}秒</div>
    </div>
  )
}
```

### 显示详细倒计时

```tsx
import { useTimeCountdown } from '@miaoma-rhooks/hooks'

function DetailedCountdown() {
  const futureDate = new Date(Date.now() + 5 * 24 * 60 * 60 * 1000) // 5天后
  const { days, hours, minutes, seconds } = useTimeCountdown(futureDate)

  return (
    <div>
      <div>{days} 天</div>
      <div>{hours} 小时</div>
      <div>{minutes} 分钟</div>
      <div>{seconds} 秒</div>
    </div>
  )
}
```

### 活动倒计时

```tsx
import { useTimeCountdown } from '@miaoma-rhooks/hooks'

function EventCountdown() {
  const eventDate = '2024-12-25T00:00:00'
  const { isTimeReached, formattedRemaining, days } = useTimeCountdown(eventDate)

  if (isTimeReached) {
    return <div>活动已开始！</div>
  }

  return (
    <div>
      <h3>距离活动开始</h3>
      {days > 0 && <div>{days} 天</div>}
      <div>{formattedRemaining}</div>
    </div>
  )
}
```

### 验证码倒计时

```tsx
import { useTimeCountdown } from '@miaoma-rhooks/hooks'

function VerificationCodeCountdown() {
  // 60秒后可以重新发送
  const resendTime = new Date(Date.now() + 60 * 1000)
  const { isTimeReached, formattedRemaining } = useTimeCountdown(resendTime)

  return (
    <button disabled={!isTimeReached}>
      {isTimeReached ? '发送验证码' : `重新发送 (${formattedRemaining})`}
    </button>
  )
}
```

## 时间格式说明

### formattedRemaining 格式

- 超过 1 小时：`HH:MM:SS` 格式
  - 例如：`02:30:45`

- 少于 1 小时：`MM:SS` 格式
  - 例如：`45:30`

### 支持的时间格式

```tsx
// 毫秒级时间戳
useTimeCountdown(1704067200000)

// 秒级时间戳
useTimeCountdown(1704067200)

// Date 对象
useTimeCountdown(new Date('2024-12-31'))

// 日期字符串
useTimeCountdown('2024-12-31T23:59:59')
```

## 注意事项

- 每秒自动更新倒计时
- 如果传入过去的时间，`isTimeReached` 立即返回 `true`
- 使用本地时区进行计算
- 精度为秒级
- 组件卸载时自动清理定时器

## 实际应用场景

### 秒杀活动

```tsx
function FlashSale() {
  const endTime = new Date('2024-12-31 23:59:59')
  const { formattedRemaining, isTimeReached } = useTimeCountdown(endTime)

  return (
    <div>
      {isTimeReached ? '活动已结束' : `距结束：${formattedRemaining}`}
    </div>
  )
}
```

### 限时优惠

```tsx
function LimitedTimeOffer() {
  const endTime = new Date(Date.now() + 24 * 60 * 60 * 1000)
  const { isTimeReached, formattedRemaining } = useTimeCountdown(endTime)

  return (
    <div>
      {isTimeReached ? '优惠结束' : `剩余：${formattedRemaining}`}
    </div>
  )
}
```

## 最佳实践

### ✅ 推荐做法

```tsx
// 使用常量或计算目标时间
const targetTime = new Date(Date.now() + 3600000)
const { formattedRemaining } = useTimeCountdown(targetTime)

// 检查 isTimeReached
const { isTimeReached } = useTimeCountdown(targetTime)
if (isTimeReached) {
  return <div>时间到</div>
}
```

### ❌ 不推荐做法

```tsx
// 不要每次渲染创建新 Date
const { formattedRemaining } = useTimeCountdown(new Date())  // 错误

// 不要在循环中创建多个倒计时
{[1,2,3].map(i => {
  const { formattedRemaining } = useTimeCountdown(...)  // 性能问题
})}
```
